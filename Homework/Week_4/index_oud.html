<!DOCTYPE html>
<!--Eveline Tiekink
11267321
HTML file for the bar chart for the UvA course Dataprocessing
-->

<html>
  <head>
    <title>Bar Chart</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.min.js"></script>
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
  </head>
  <body>
    <h1><font face="verdana" color="pink">Bar Chart of the percentage of the energy producing of 2016 </font></h1>
    <h2><font face="verdana" color="darkblue"> Made by Eveline Tiekink - 11267321 </font></h2>
    <p>This is a beautiful colored bar chart from data.</p>

    <script type="text/javascript">

      // puts the right data (json file) in
    	d3.json("data_2.json").then(function(data){
        var dataValues = [];

        // defines the countries and the values
        var countries = Object.keys(data);
        for (var i = 0; i < countries.length; i++) {
            dataValues.push(parseFloat(data[countries[i]]["Value"]));
        }

        var padding = 10
        var width = 800;
        var height = 200;
        var svg = d3.select("body")
                  .append("svg")
                  .attr("width", 1200)
                  .attr("height", 1200);

        // var tooltip = d3.select("body")
        //               	.append("div")
        //                 .style("width", "20px")
        //                 .text("hoi")
        //               	.style("position", "absolute")
        //               	.style("z-index", "10")
        //               	.style("visibility", "hidden")

      var tip = d3.tip()
                  .attr('class', 'd3-tip')
                  .offset([-10, 0])
                  .html(function(d) {
                    return "<strong>Value:</strong> <span style='color:red'>" + d + "</span>";
                  })

        // console.log(Math.max(values))
        var max = Math.max.apply(null, dataValues);
        // deze kan je beter omzetten naar een yas
        var yScale = d3.scaleLinear()
                       .domain([0, 100])
                       .range([height, 0])
        var xScale= d3.scaleOrdinal()
                       .domain(countries)
                       .range([0, width])

        svg.call(tip);

        var bars = svg.selectAll("rect")
                      .data(dataValues)
                      .enter()
                      .append("rect")
                      .attr("class", "bar")
                      .attr("width", 20)
                      .attr("height", function(d){
                        return height - yScale(d);
                      })
                      .attr("x", function(d, i){
                        return 40 + (width / countries.length)* i
                      })
                      .attr("y", function(d, i) {
                        return yScale(d);
                      })
                      .attr("fill", "pink")
                    	.on('mouseover', tip.show)
                      .on('mouseout', tip.hide)


//           .attr("y", function(d) {
//     return h - d;  //Height minus data value
// })
//
// .attr("height", function(d) {
//     return d;  //Just the data value
// });

        var yAxis = d3.axisLeft()
                   .scale(yScale);
        svg.append("g")
           .attr("transform", "translate(" + 40 + "," + 0 + ")")
           .call(yAxis);

          // //add a value label to under each bar
          // bars.append("text")
          //     .attr("class", "label")

        var xAxis = d3.axisBottom()
                   .scale(xScale);

        var barWidth = width / (countries.length);

        // add labels
        svg.selectAll("text.axis")
           .data(countries)
           .enter()
           .append("text")
           // .attr("class","barLabel")
           .attr("transform", "translate(0," + height + ")")
           .style("font-size", "10px")
           .attr("y", 10)
           .attr("id", function(d){
                return d;
               })
           .attr("x", function(d,i){
                   return (width  - ((i + .5) * barWidth) + 40)
               })
           // .attr("x", 100)
           .text(function(d){
                return d
               })
           .attr("text-anchor", "middle");

        // svg.call(tooltip)

                     // .attr("transform", "translate(0," + height + ")")
          // svg.append("g")
          //    .attr("transform", "translate(20," + height + ")")
          //    .call(xAxis);
          // //add a value label to under each bar
          // bars.append("text")
          //     .attr("class", "label")

          //
          svg.append("text")
             .attr("class", "textAxis")
             .style("font-size", "12px")
             .attr("text-anchor", "middle")  // this makes it easy to centre the text as the transform is applied to the anchor
             .attr("transform", "translate(" + (width/2) + ","+ (height + 40) + ")")  // centre below axis
             .text("Country");

          // now add titles to the axes
          svg.append("text")
              .attr("class", "textAxis")
              .style("font-size", "12px")
              .attr("text-anchor", "middle")  // this makes it easy to centre the text as the transform is applied to the anchor
              // .attr("transform", "translate(" + (width/2) + ","+ (height + 20) + ")")
              .attr("transform", "translate(" + 10 + ","+ (height / 2) +")rotate(-90)")  // text is drawn off the screen top left, move down and out and rotate
              .text("Percentage (%)");


          for (var i = 0; i < countries.length; i++) {
            scaleOrdinal(countries[i]);
          }

          dataValues.push(parseFloat(data[countries[i]]["Value"]));

          // var colours = d3.scaleOrdinal()
          //                 .range(["#6F257F", "#CA0D59"]);

          // g.selectAll(".bar")
          //     	.data(data)
          //     .enter().append("rect")
          //       .attr("x", function(d) { return x(d.area); })
          //       .attr("y", function(d) { return y(d.value); })
          //       .attr("width", x.bandwidth())
          //       .attr("height", function(d) { return height - y(d.value); })
          //       .attr("fill", function(d) { return colours(d.area); })
          //       .on("mousemove", function(d){
          //           tooltip
          //             .style("left", d3.event.pageX - 50 + "px")
          //             .style("top", d3.event.pageY - 70 + "px")
          //             .style("display", "inline-block")
          //             .html((d.country) + "<br>" + "Â£" + (d.value));
          //       })
          //   		.on("mouseout", function(d){ tooltip.style("display", "none");});
          //


                //
                // function mouseover() {
                //   div.style("display", "inline");
                // }
                //
                // function mousemove() {
                //   div
                //       .text(d3.event.pageX + ", " + d3.event.pageY)
                //       .style("left", (d3.event.pageX - 34) + "px")
                //       .style("top", (d3.event.pageY - 12) + "px");
                // }
                //
                // function mouseout() {
                //   div.style("display", "none");
                // }

          // dataValues.push(parseFloat(data[countries[i]]["Value"]));
          // //make x axis to show bar names
          // var xAxis = d3.svg.axis()
          //     .scale(x)
          //     //no tick marks
          //     .tickSize(0)
          //     .orient("height");
          //
          // var gy = svg.append("g")
          //     .attr("class", "y axis")
          //     .call(yAxis)
        });
    // })

    </script>


    <!-- <div class="bar" style="height:50 px;"></div>
    <div class="bar" style="height:0.001 px;"></div> -->
  </body>
</html>
